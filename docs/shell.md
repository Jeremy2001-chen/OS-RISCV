# 用户进程和Shell

## 基本情况

为了对内核进行测试，我们编写了一部分用户进程，并实现了一个 Shell 界面，可以执行一些简单的命令。



## 用户进程地址空间

```c
TRAMPOLINE_TOP -----> +----------------------------+----0x0000 0040 0000 0000-------
                      |                            |                          /|\
                      |        Trampoline          |    8192 Byte         trampoline
                      |                            |                          \|/
   U_STACK_TOP -----> +----------------------------+----0x0000 003f ffff 7ed4-----
                      |                            |                          /|\
    				  |        User Stack          |    1 GB                   |
                      |                            |                           |
    U_HEAP_TOP -----> +----------------------------+----0x0000 003e ffff 7ed4  |
                      |                            |                           |
                      |         User Heap          |    1 GB                   |
                      |                            |                           |
 U_HEAP_BOTTOM -----> +----------------------------+----0x0000 003d ffff 7ed4  |
                      |                            |                           |
                      |                            |                           |
                      |                            |                           |
                      +----------------------------+----0x0000 0000 0100 3000  |
                      |                            |                           |
                      |         User Buffer        |    12288 Byte            user
                      |                            |                           |
                      +----------------------------+----0x0000 0000 0100 0000  |
                      |                            |                           |
                      |                            |                           |
                      |                            |                           |
      U_DATA   -----> +----------------------------+                           |
                      |                            |                           |
                      |                            |                           |
                      |                            |                           |    
      U_TEXT   -----> +----------------------------+----0x0000 0000 00a0 0000  |
                      |                            |                          \|/
     0 ------------>  +----------------------------+ -----------------------------
```

* `U_TEXT` 是用户进程代码段
* `U_DATA` 是用户进程数据段
* `U_BUFFER` 是用户进程缓冲区
* `U_HEAP` 是用户堆区
* `U_STACK` 是用户栈区
* `Trampoline` 是用户内核切换代码段